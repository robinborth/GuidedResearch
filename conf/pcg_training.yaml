# @package _global_

defaults:
  - data: linsys_pose 
  - callbacks: default
  - logger: wandb
  - hydra: default
  - paths: default
  - optional local: default
  - _self_

seed: 123
device: cuda
train: True
eval: True
eval_max_iter: 15
eval_batch_size: 32
task_name: pcg_training
tags: 
  - ${task_name}

data:
  batch_size: 1
  split: [0.8, 0.1, 0.1]

trainer:
  _target_: lightning.pytorch.trainer.Trainer
  default_root_dir: ${paths.output_dir}
  accelerator: ${device}
  # training
  min_epochs: 1 
  max_epochs: 5000
  # debugging
  overfit_batches: 1
  limit_val_batches: 0  # disable
  check_val_every_n_epoch: 20
  num_sanity_val_steps: 0
  log_every_n_steps: 1

model:
  _target_: lib.optimizer.pcg.PCGSolver
  max_iter: 1
  gradients: backprop
  verbose: False
  condition_net:
    _target_: lib.optimizer.pcg.DiagonalOffsetConditionNet
    _partial_: True
    unknowns: 6
    hidden_dim: 36
    num_layers: 1
  # optimization
  scheduler: null
  monitor: train/loss
  optimizer:
    _target_: torch.optim.Adam
    _partial_: True
    lr: 1e-06
  